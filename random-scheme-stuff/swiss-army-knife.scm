;; -*-scheme-*-
;; ... would have:
;; 
;; bottle opener with large screwdriver and wire stripper
;; can opener with small screwdriver
;; corkscrew
;; fine screwdriver 
;; key ring 
;; locking blade
;; phillips screwdriver 
;; scissors

(define swiss-army-knives 
  '((
     "outdoors swisschamp®"
     (
      "ball point pen"
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "fine screwdriver"
      "fish scaler with hook disgorger and ruler"
      "hook"
      "key ring"
      "large blade"
      "magnifying glass"
      "metal saw with metal file & nail file"
      "mini screwdriver"
      "phillips screwdriver"
      "pliers with wire cutter"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "straight pin"
      "toothpick"
      "tweezers"
      "wood chisel"
      "wood saw"
      ))
    (
     "outdoors tinker"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "large blade"
      "phillips screwdriver"
      "reamer with sewing eye"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "outdoors super tinker"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "hook"
      "key ring"
      "large blade"
      "phillips screwdriver"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "outdoors spartan"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "key ring"
      "large blade"
      "reamer with sewing eye"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "outdoors explorer"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "hook"
      "key ring"
      "large blade"
      "magnifying glass"
      "phillips screwdriver"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "outdoors camper"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "key ring"
      "large blade"
      "reamer with sewing eye"
      "small blade"
      "toothpick"
      "tweezers"
      "wood saw"
      ))
    (
     "outdoors fieldmaster®"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "hook"
      "key ring"
      "large blade"
      "phillips screwdriver"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      "wood saw"
      ))
    (
     "outdoors deluxe tinker"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "hook"
      "key ring"
      "large blade"
      "phillips screwdriver"
      "pliers with wire cutter"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "outdoors hiker®"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "large blade"
      "phillips screwdriver"
      "reamer with sewing eye"
      "small blade"
      "toothpick"
      "tweezers"
      "wood saw"
      ))
    (
     "home|office executive"
     (
      "key ring"
      "large blade"
      "nail file with nail cleaner"
      "orange peeler with screwdriver tip"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "home|office recruit®"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "large blade"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "home|office pocket pal"
     (
      "large blade small blade"
      ))
    (
     "home|office money clip"
     (
      "large blade"
      "money clip"
      "nail file with nail cleaner"
      "scissors"
      ))
    (
     "home|office ambassador"
     (
      "large blade"
      "nail file with nail cleaner"
      "scissors"
      "toothpick"
      "tweezers"
      ))
    (
     "home|office waiter"
     (
      "combination tool (bottle opener, can opener, screwdriver & wire stripper)"
      "corkscrew"
      "key ring"
      "large blade"
      "toothpick"
      "tweezers"
      ))
    (
     "sports rainier"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "hook"
      "key ring"
      "reamer with sewing eye"
      "scissors"
      "serrated large blade"
      "small blade"
      "toothpick"
      "tweezers"
      "wood saw"
      ))
    (
     "sports mckinley"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "phillips screwdriver"
      "reamer with sewing eye"
      "serrated large blade"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "sports matterhorn"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "hook"
      "key ring"
      "phillips screwdriver"
      "pliers with wire cutter"
      "reamer with sewing eye"
      "scissors"
      "serrated large blade"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "outdoors ii deluxe climber"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "hook"
      "key ring"
      "large blade"
      "pliers with wire cutter"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "outdoors ii golfer"
     (
      "ball point pen"
      "corkscrew"
      "divot fixer"
      "hook"
      "key ring"
      "large blade"
      "mini screwdriver"
      "scissors"
      "straight pin"
      "toothpick"
      "tweezers"
      ))
    (
     "outdoors ii climber®"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "hook"
      "key ring"
      "large blade"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "outdoors ii huntsman"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "hook"
      "key ring"
      "large blade"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      "wood saw"
      ))
    (
     "outdoors ii fisherman"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "fish scaler with hook disgorger and ruler"
      "hook"
      "key ring"
      "large blade"
      "phillips screwdriver"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "outdoors ii ranger"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "fine screwdriver"
      "hook"
      "key ring"
      "large blade"
      "metal saw with metal file & nail file"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      "wood chisel"
      "wood saw"
      ))
    (
     "outdoors ii pioneer"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "large blade"
      "sturdy reamer"
      ))
    (
     "travel ambassador"
     (
      "large blade"
      "nail file with nail cleaner"
      "scissors"
      "toothpick"
      "tweezers"
      ))
    (
     "travel recruit®"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "large blade"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "travel yeoman"
     (
      "ball point pen"
      "combination tool (bottle opener, can opener, screwdriver & wire stripper)"
      "corkscrew"
      "hook"
      "key ring"
      "large blade"
      "magnifying glass"
      "mini screwdriver"
      "phillips screwdriver"
      "scissors"
      "straight pin"
      "toothpick"
      "tweezers"
      ))
    (
     "travel traveler's kit plus"
     (
      "ball point pen"
      "black leather pouch"
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "compass/ruler with thermometer"
      "corkscrew"
      "fine screwdriver"
      "fish scaler with hook disgorger and ruler"
      "hook"
      "key ring"
      "large blade"
      "magnifying glass"
      "metal saw with metal file & nail file"
      "mini screwdriver"
      "phillips screwdriver"
      "pliers with wire cutter"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "solitaire flashlite"
      "straight pin"
      "toothpick"
      "tweezers"
      "wood chisel"
      "wood saw"
      ))
    (
     "travel traveler's kit"
     (
      "ball point pen"
      "black leather pouch"
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "compass/ruler with thermometer"
      "corkscrew"
      "hook"
      "key ring"
      "large blade"
      "magnifying glass"
      "mini screwdriver"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "solitaire flashlite"
      "straight pin"
      "toothpick"
      "tweezers"
      "wood saw"
      ))
    (
     "tradesman soldier"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "large blade"
      "sturdy reamer"
      ))
    (
     "tradesman mechanic"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "large blade"
      "phillips screwdriver"
      "pliers with wire cutter"
      "reamer with sewing eye"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "tradesman ranger"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "fine screwdriver"
      "hook"
      "key ring"
      "large blade"
      "metal saw with metal file & nail file"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      "wood chisel"
      "wood saw"
      ))
    (
     "tradesman craftsman"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "fine screwdriver"
      "hook"
      "key ring"
      "large blade"
      "metal saw with metal file & nail file"
      "phillips screwdriver"
      "pliers with wire cutter"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      "wood chisel"
      "wood saw"
      ))
    (
     "tradesman electrician"
     (
      "bottle opener with large screwdriver and wire stripper"
      "electrician blade"
      "large blade"
      "sturdy reamer"
      ))
    (
     "lockblade picnicker"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "key ring"
      "locking serrated blade"
      "reamer with sewing eye"
      "toothpick"
      "tweezers"
      ))
    (
     "lockblade rucksack"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "key ring"
      "locking blade"
      "reamer with sewing eye"
      "toothpick"
      "tweezers"
      "wood saw"
      ))
    (
     "lockblade adventurer"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "locking blade"
      "phillips screwdriver"
      "reamer with sewing eye"
      "toothpick"
      "tweezers"
      ))
    (
     "lockblade helmsman"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "corkscrew"
      "key ring"
      "locking serrated blade"
      "reamer with sewing eye"
      "shackle key"
      "toothpick"
      "tweezers"
      ))
    (
     "lockblade hunter"
     (
      "combination tool (bottle opener, can opener, screwdriver & wire stripper)"
      "corkscrew"
      "key ring"
      "locking blade"
      "reamer with sewing eye"
      "serrated gutting blade"
      "toothpick"
      "tweezers"
      "wood saw"
      ))
    (
     "boy scout mechanic"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "large blade"
      "phillips screwdriver"
      "pliers with wire cutter"
      "reamer with sewing eye"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "boy scout classic"
     (
      "key ring"
      "nail file with screwdriver tip"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "boy scout tinker"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "large blade"
      "phillips screwdriver"
      "reamer with sewing eye"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "boy scout cub scout pocket pal"
     (
      "large blade small blade"
      ))
    (
     "boy scout yeoman"
     (
      "ball point pen"
      "combination tool (bottle opener, can opener, screwdriver & wire stripper)"
      "corkscrew"
      "hook"
      "key ring"
      "large blade"
      "magnifying glass"
      "mini screwdriver"
      "phillips screwdriver"
      "scissors"
      "straight pin"
      "toothpick"
      "tweezers"
      ))
    (
     "boy scout sentry"
     (
      "large blade"
      ))
    (
     "boy scout adventurer"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "locking blade"
      "phillips screwdriver"
      "reamer with sewing eye"
      "toothpick"
      "tweezers"
      ))
    (
     "boy scout huntsman"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "hook"
      "key ring"
      "large blade"
      "phillips screwdriver"
      "reamer with sewing eye"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      "wood saw"
      ))
    (
     "licensed major league baseball"
     (
      "key ring"
      "nail file with screwdriver tip"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "licensed nfl collection"
     (
      "key ring"
      "nail file with screwdriver tip"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "licensed outward bound tinker"
     (
      "bottle opener with large screwdriver and wire stripper"
      "can opener with small screwdriver"
      "key ring"
      "large blade"
      "outward bound logo"
      "phillips screwdriver"
      "reamer with sewing eye"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "licensed ducks unlimited classic"
     (
      "ducks unlimited logo"
      "key ring"
      "nail file with screwdriver tip"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))
    (
     "licensed national hockey league collection"
     (
      "key ring"
      "nail file with screwdriver tip"
      "scissors"
      "small blade"
      "toothpick"
      "tweezers"
      ))))

(require 'sort)
(require 'filter)

(sort
 (let ()
   (define (check-model thing)
     (define (all-strings? seq)
       (or (null? seq)
           (and (string? (car seq))
                (all-strings? (cdr seq)))))

     (if (not (and
               (list? thing)
               (string? (car thing))
               (list? (cadr thing))
               (all-strings? (cadr thing))))
         (error "That's not a Swiss Army Knife model." thing)))

   (define (model-has-blade? model blade)

     (check-model model)
     (and (member blade  (cadr model)) #t))

   (define (number-of-desired-blades model)
     (check-model model)
     (apply
      +
      (map (lambda (bool)
             (if bool 1 0))
           (map (lambda (blade)
                  (model-has-blade? model blade)) 
                (list 
                 "bottle opener with large screwdriver and wire stripper"
                 "can opener with small screwdriver"
                 "corkscrew"
                 "fine screwdriver "
                 "key ring "
                 "locking blade"
                 "phillips screwdriver "
                 "scissors"
                 )))))
     
   (map (lambda (model) (cons (car model) (number-of-desired-blades model))) swiss-army-knives)
   )
 (lambda (thing1 thing2)
   (< (cdr thing1)
      (cdr thing2))))